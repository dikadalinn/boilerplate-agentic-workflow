# **05 \- Security, Compliance & Performance SLA**

**Project Name:** \[Project Name\]

**Generated By:** @system-analyst

**Reference:** docs/00-business-context/01-brd.md, docs/00-business-context/04-nfr.md, docs/01-system-context/01-architecture.md

## **1\. Authentication & Identity Management**

\<\!-- AI INSTRUCTION: Define how the system authenticates users based on the architecture. Detail the token mechanism, expiry times, and refresh strategies. \--\>

* **Authentication Method:** \[e.g., JWT (JSON Web Tokens) / OAuth 2.0 / Session-based\]
* **Token Lifecycle:** \* **Access Token:** \[e.g., Expires in 15 minutes, signed with HS256\]
  * **Refresh Token:** \[e.g., Expires in 7 days, stored in HttpOnly secure cookie\]
* **Password Hashing:** \[e.g., Argon2 or bcrypt with a minimum cost factor of 12\]

## **2\. Authorization & RBAC (Role-Based Access Control)**

\<\!-- AI INSTRUCTION: Translate the User Roles from the BRD into a technical authorization strategy. Explain how the backend validates these roles (e.g., Middleware guards). \--\>

* **Authorization Strategy:** \[e.g., Role-based claims embedded inside the JWT payload\]
* **Enforcement Level:** \[e.g., All protected routes MUST pass through an authGuard middleware. Tenant-specific routes MUST pass through a tenantGuard that verifies the user's project\_id.\]
* **Permission Matrix Enforcement:**
  * **Super Admin:** Bypass all tenant restrictions.
  * **Project Manager:** Validated against project\_members table for the specific project\_id.
  * **Staff:** Can only mutate records where assigned\_to matches their user\_id.

## **3\. Data Encryption & Protection**

\<\!-- AI INSTRUCTION: Specify the encryption standards for data traveling across the network and data stored in the database. \--\>

* **Data in Transit:** \[e.g., Enforced TLS 1.3 / HTTPS for all client-server communication. WSS for WebSockets.\]
* **Data at Rest:** \[e.g., Database volumes encrypted using AES-256 (AWS KMS or equivalent). PII (Personally Identifiable Information) such as phone numbers encrypted at the column level if required.\]
* **Secrets Management:** \[e.g., API keys and database credentials MUST NOT be hardcoded. Use environment variables injected via AWS Secrets Manager or Vercel Env.\]

## **4\. Compliance & Data Privacy**

\<\!-- AI INSTRUCTION: Mention the compliance standards the system must adhere to based on the target market (e.g., GDPR, HIPAA, or UU PDP for Indonesia). Detail the technical implications. \--\>

* **Target Compliance:** \[e.g., UU PDP (Indonesia Personal Data Protection Act) & basic GDPR principles\]
* **Technical Implications:**
  * **Right to be Forgotten:** Implement a "Soft Delete" mechanism (deleted\_at timestamp) for 30 days, followed by a hard deletion cron job.
  * **Data Export:** Users must be able to export their core data in standard formats (CSV/JSON).

## **5\. Threat Prevention Strategies**

\<\!-- AI INSTRUCTION: Outline how the system protects against common web vulnerabilities (OWASP Top 10). \--\>

* **Brute Force & Credential Stuffing:** \[e.g., Lock account for 15 minutes after 5 consecutive failed login attempts. Rate limiting on /api/auth/login.\]
* **XSS (Cross-Site Scripting):** \[e.g., Frontend framework (React) automatically escapes variables. Enforce strict Content Security Policy (CSP) headers.\]
* **CSRF (Cross-Site Request Forgery):** \[e.g., Use anti-CSRF tokens if using Session Cookies, or rely on Authorization headers for JWT.\]
* **SQL Injection:** \[e.g., Strictly use Prisma ORM / Parameterized queries. Never concatenate raw SQL strings.\]

## **6\. Performance SLA (Service Level Agreement)**

\<\!-- AI INSTRUCTION: Translate the abstract performance requirements from the NFR document into concrete technical Service Level Agreements (SLA) that the developers must test against. \--\>

* **API Response Time Targets:**
  * **Light Endpoints (e.g., Auth, GET User):** \< 200ms at 95th percentile.
  * **Heavy Endpoints (e.g., Reports, Bulk Import init):** \< 800ms at 95th percentile.
* **Database Query Limits:** \[e.g., No single operational query should take more than 50ms. Indexes must be created for all frequently queried columns.\]
* **Background Jobs:** \[e.g., Bulk email dispatches must be offloaded to a Redis queue and not block the main Node.js event loop.\]