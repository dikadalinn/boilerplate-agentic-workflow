# **04 \- 3rd Party Integrations & Data Sync**

**Project Name:** \[Project Name\]

**Generated By:** @system-analyst

**Reference:** docs/00-business-context/01-brd.md, docs/00-business-context/05-monetization-strategy.md (if any)

## **1\. Integration Landscape Overview**

\<\!-- AI INSTRUCTION: Provide a brief summary of all external services the system relies on based on the BRD and NFR. IF an integration (like Payment) is NOT required by the business context, clearly state "Not Applicable for MVP" and skip generating its specific details. \--\>

\[Integration Overview\]

## **2\. Payment Gateway Integration**

\<\!-- AI INSTRUCTION: If monetization/payments are required (e.g., Stripe, Xendit, Midtrans), specify the provider, the main payment flow, and the REQUIRED Webhook events the backend must listen to. \--\>

* **Provider:** \[e.g., Stripe\]
* **Payment Flow:** \[e.g., Checkout Session / Subscriptions\]
* **Required Webhook Events to Listen:**
  * checkout.session.completed: \[Action to take, e.g., Update tenant subscription status to ACTIVE\]
  * invoice.payment\_failed: \[Action to take, e.g., Downgrade tenant to FREE tier and send email\]

## **3\. Email & Communication Service**

\<\!-- AI INSTRUCTION: If the app sends transactional emails (e.g., SendGrid, AWS SES), define the provider, trigger conditions, and expected dynamic variables for the templates. \--\>

* **Provider:** \[e.g., SendGrid\]
* **Core Email Triggers:**
  * **Event:** User Registration
    * **Trigger Condition:** Upon successful insertion into the users table.
    * **Dynamic Variables:** {{first\_name}}, {{verification\_link}}
  * **Event:** \[Another Event based on BRD\]
    * **Trigger Condition:** \[Condition\]
    * **Dynamic Variables:** \[Variables\]

## **4\. Push Notifications (Mobile/Web)**

\<\!-- AI INSTRUCTION: If push notifications are required, define the provider (e.g., Firebase Cloud Messaging \- FCM, Apple APNs) and the standard JSON payload structure. \--\>

* **Provider:** \[e.g., FCM (Firebase Cloud Messaging)\]
* **Standard Payload Structure:**

{
  "message": {
    "token": "user\_device\_token",
    "notification": {
      "title": "Notification Title",
      "body": "Notification Body"
    },
    "data": {
      "click\_action": "FLUTTER\_NOTIFICATION\_CLICK",
      "route": "/specific-screen",
      "entity\_id": "1234-5678"
    }
  }
}

## **5\. Real-Time Data Synchronization (WebSockets)**

\<\!-- AI INSTRUCTION: If the NFR demands real-time features (e.g., live chat, live Kanban board updates), define the WebSocket connection strategy. If not required, state "Not Applicable". \--\>

* **Technology:** \[e.g., Socket.io / AWS API Gateway WebSockets\]
* **Connection Endpoint:** wss://api.\[projectname\].com/live
* **Heartbeat/Ping Interval:** \[e.g., 30 seconds to keep connection alive\]
* **Core Events:**
  * Subscribe: Client joins a specific "room" (e.g., project\_123).
  * Broadcast: Server emits CARD\_MOVED event to all users in the room.

## **6\. External Dependencies & Fallback Strategy**

\<\!-- AI INSTRUCTION: Identify the most critical external dependencies and define the fallback plan if they experience downtime (referencing the Appendix B of standard enterprise docs). \--\>

| External Service | Criticality Level | Fallback Strategy / Graceful Degradation |
| :---- | :---- | :---- |
| **\[e.g., SendGrid\]** | Medium | \[e.g., Queue emails in the database and retry using a background cron job every 15 minutes.\] |
| **\[e.g., Stripe\]** | High | \[e.g., Display a maintenance banner on the checkout page; do not block users from accessing already paid features.\] |
| **\[Service 3\]** | \[Level\] | \[Strategy\] |

